{"version":3,"file":"vue-gtag.umd.min.js","sources":["../src/util.js","../src/api/query.js","../src/install.js","../src/api/config.js","../src/api/event.js","../src/api/pageview.js","../src/api/screenview.js","../src/api/ga-disable.js","../src/api/opt-out.js","../src/api/index.js","../src/api/custom-map.js","../src/api/time.js","../src/api/exception.js","../src/api/linker.js","../src/api/purchase.js","../src/api/refund.js","../src/api/set.js","../src/api/opt-in.js","../src/extend.js","../src/page-tracker.js","../src/bootstrap.js","../src/index.js"],"sourcesContent":["export const noop = function() {};\n\nexport function loadScript(url, domain) {\n  return new Promise((resolve, reject) => {\n    const head = document.head || document.getElementsByTagName(\"head\")[0];\n    const script = document.createElement(\"script\");\n\n    script.async = true;\n    script.src = url;\n    script.charset = \"utf-8\";\n\n    if (domain) {\n      const link = document.createElement(\"link\");\n\n      link.href = domain;\n      link.rel = \"preconnect\";\n\n      head.appendChild(link);\n    }\n\n    head.appendChild(script);\n\n    script.onload = resolve;\n    script.onerror = reject;\n  });\n}\n\nexport function warn(msg, err) {\n  console.warn(\"[vue-gtag] \" + msg);\n\n  if (err && err.stack) {\n    console.warn(err.stack);\n  }\n}\n\nexport function isFn(item) {\n  return typeof item === \"function\";\n}\n\nexport function isObject(item) {\n  return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nexport function mergeDeep(target, ...sources) {\n  if (!sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (!isObject(target) || !isObject(source)) {\n    return;\n  }\n\n  for (const key in source) {\n    if (isObject(source[key])) {\n      if (!target[key]) {\n        Object.assign(target, { [key]: {} });\n      }\n\n      mergeDeep(target[key], source[key]);\n    } else {\n      Object.assign(target, { [key]: source[key] });\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n","import { getOptions } from \"../install\";\n\nexport default function(...args) {\n  const { globalObjectName } = getOptions();\n\n  if (typeof window === \"undefined\") {\n    return;\n  }\n\n  window[globalObjectName](...args);\n}\n","import { noop, mergeDeep } from \"./util\";\nimport extend from \"./extend\";\nimport bootstrap from \"./bootstrap\";\n\nlet Vue;\nlet Router;\nlet options = {\n  pageTrackerTemplate: noop,\n  onBeforeTrack: noop,\n  onAfterTrack: noop,\n  onReady: noop,\n  enabled: true,\n  disableScriptLoad: false,\n  bootstrap: true,\n  globalObjectName: \"gtag\",\n  pageTrackerEnabled: true,\n  pageTrackerScreenviewEnabled: false,\n  defaultGroupName: \"default\",\n  includes: null,\n  config: null\n};\n\nexport const getOptions = () => options;\nexport const setOptions = _options => mergeDeep(options, _options);\nexport const getVue = () => Vue;\nexport const getRouter = () => Router;\n\nexport function install(_Vue, _options = {}, _Router) {\n  Vue = _Vue;\n  Router = _Router;\n\n  setOptions(_options);\n\n  extend();\n\n  if (!options.bootstrap) {\n    return;\n  }\n\n  bootstrap();\n}\n","import query from \"./query\";\nimport { getOptions } from \"../install\";\n\nexport default (...args) => {\n  const { config, includes } = getOptions();\n\n  query(\"config\", config.id, ...args);\n\n  if (Array.isArray(includes)) {\n    includes.forEach(domain => {\n      query(\"config\", domain.id, ...args);\n    });\n  }\n};\n","import { getOptions } from \"../install\";\nimport query from \"./query\";\n\nexport default (name, _params = {}) => {\n  const { defaultGroupName, includes } = getOptions();\n  const params = _params;\n\n  if (includes && params.send_to == null) {\n    params.send_to = includes\n      .map(include => include.id)\n      .concat(defaultGroupName);\n  }\n\n  query(\"event\", name, params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  const [arg] = args;\n  let params = {};\n\n  if (typeof arg === \"string\") {\n    params = {\n      page_path: arg,\n      page_location: window.location.href\n    };\n  } else {\n    params = arg;\n  }\n\n  event(\"page_view\", params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"screen_view\", ...args);\n};\n","import { getOptions } from \"../install\";\n\nexport default (value = true) => {\n  const { includes, config } = getOptions();\n\n  window[`ga-disable-${config.id}`] = value;\n\n  if (Array.isArray(includes)) {\n    includes.forEach(domain => {\n      window[`ga-disable-${domain.id}`] = value;\n    });\n  }\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(true);\n};\n","import query from \"./query\";\nimport config from \"./config\";\nimport event from \"./event\";\nimport pageview from \"./pageview\";\nimport screenview from \"./screenview\";\nimport customMap from \"./custom-map\";\nimport time from \"./time\";\nimport exception from \"./exception\";\nimport linker from \"./linker\";\nimport purchase from \"./purchase\";\nimport refund from \"./refund\";\nimport set from \"./set\";\nimport optIn from \"./opt-in\";\nimport optOut from \"./opt-out\";\n\nexport default {\n  query,\n  config,\n  event,\n  pageview,\n  screenview,\n  customMap,\n  time,\n  exception,\n  linker,\n  purchase,\n  refund,\n  set,\n  optIn,\n  optOut\n};\n","import config from \"./config\";\n\nexport default map => {\n  config({\n    custom_map: map\n  });\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"timing_complete\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"exception\", ...args);\n};\n","import config from \"./config\";\n\nexport default params => {\n  config(\"linker\", params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"purchase\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"refund\", ...args);\n};\n","import query from \"./query\";\n\nexport default (...args) => {\n  query(\"set\", ...args);\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(false);\n};\n","import { getVue } from \"./install\";\nimport api from \"./api\";\n\nexport default () => {\n  const Vue = getVue();\n\n  Vue.$gtag = Vue.prototype.$gtag = api;\n};\n","import { getVue, getRouter, getOptions } from \"./install\";\nimport { warn } from \"./util\";\nimport pageview from \"./api/pageview\";\nimport screenview from \"./api/screenview\";\n\nexport const trackPage = (to = {}, from = {}) => {\n  if (to.path === from.path) {\n    return;\n  }\n\n  const {\n    pageTrackerTemplate,\n    pageTrackerScreenviewEnabled,\n    appName\n  } = getOptions();\n\n  let template;\n  const customTemplate = pageTrackerTemplate(to, from);\n\n  if (customTemplate) {\n    template = customTemplate;\n  } else if (pageTrackerScreenviewEnabled) {\n    template = {\n      app_name: appName,\n      screen_name: to.name\n    };\n  } else {\n    template = {\n      page_title: to.name,\n      page_path: to.path,\n      page_location: window.location.href\n    };\n  }\n\n  if (pageTrackerScreenviewEnabled && !template.app_name) {\n    warn(\"To use the screenview, add the appName to the plugin options\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled && !template.screen_name) {\n    warn(\"To use the screenview, name your routes\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled) {\n    screenview(template);\n    return;\n  }\n\n  pageview(template);\n};\n\nexport const init = Router => {\n  const Vue = getVue();\n  const { onBeforeTrack, onAfterTrack } = getOptions();\n\n  /* istanbul ignore next */\n  Router.onReady(current => {\n    Vue.nextTick().then(() => {\n      trackPage(current);\n    });\n\n    Router.afterEach((to, from) => {\n      Vue.nextTick().then(() => {\n        onBeforeTrack(to, from);\n        trackPage(to, from);\n        onAfterTrack(to, from);\n      });\n    });\n  });\n};\n\nexport default () => {\n  const Router = getRouter();\n\n  if (!Router) {\n    return;\n  }\n\n  init(Router);\n};\n","import { warn, isFn, loadScript } from \"./util\";\nimport { getOptions } from \"../src/install\";\nimport optOut from \"./api/opt-out\";\nimport pageTracker from \"./page-tracker\";\n\nexport default function() {\n  if (typeof document === \"undefined\" || typeof window === \"undefined\") {\n    return;\n  }\n\n  const {\n    enabled,\n    globalObjectName,\n    config,\n    pageTrackerEnabled,\n    onReady,\n    disableScriptLoad\n  } = getOptions();\n\n  if (!enabled) {\n    optOut();\n  }\n\n  if (window[globalObjectName] == null) {\n    window.dataLayer = window.dataLayer || [];\n    window[globalObjectName] = function() {\n      window.dataLayer.push(arguments);\n    };\n  }\n\n  window[globalObjectName](\"js\", new Date());\n\n  if (pageTrackerEnabled) {\n    pageTracker();\n  }\n\n  if (disableScriptLoad) {\n    return;\n  }\n\n  const domain = \"https://www.googletagmanager.com\";\n  const resource = `${domain}/gtag/js?id=${config.id}`;\n\n  return loadScript(resource, domain)\n    .then(() => {\n      const library = window[globalObjectName];\n\n      if (isFn(onReady)) {\n        onReady(library);\n      }\n\n      return library;\n    })\n    .catch(error => {\n      warn(\"Ops! Something happened and gtag.js couldn't be loaded\", error);\n      return error;\n    });\n}\n","import { setOptions as _setOptions, install } from \"./install\";\nimport _bootstrap from \"./bootstrap\";\nimport api from \"./api\";\n\nexport default install;\nexport { install };\n\nexport const bootstrap = _bootstrap;\nexport const setOptions = _setOptions;\n\n// export api for usages outside Vuejs context\nexport const query = api.query;\nexport const config = api.config;\nexport const event = api.event;\nexport const pageview = api.pageview;\nexport const screenview = api.screenview;\nexport const customMap = api.customMap;\nexport const time = api.time;\nexport const exception = api.exception;\nexport const linker = api.linker;\nexport const purchase = api.purchase;\nexport const set = api.set;\nexport const optIn = api.optIn;\nexport const optOut = api.optOut;\n"],"names":["noop","warn","msg","err","console","stack","isObject","item","_typeof","Array","isArray","globalObjectName","getOptions","window","Vue","Router","args","config","includes","query","id","forEach","domain","name","_params","defaultGroupName","params","send_to","map","include","concat","arg","page_path","page_location","location","href","event","value","disable","pageview","screenview","customMap","custom_map","time","exception","linker","purchase","refund","set","optIn","optOut","getVue","$gtag","prototype","api","trackPage","to","from","path","template","pageTrackerTemplate","pageTrackerScreenviewEnabled","appName","customTemplate","app_name","screen_name","page_title","getRouter","onBeforeTrack","onAfterTrack","onReady","current","nextTick","then","afterEach","init","document","enabled","pageTrackerEnabled","disableScriptLoad","dataLayer","push","arguments","Date","pageTracker","url","Promise","resolve","reject","head","getElementsByTagName","script","createElement","async","src","charset","link","rel","appendChild","onload","onerror","loadScript","library","catch","error","options","bootstrap","setOptions","_options","mergeDeep","target","sources","length","source","shift","key","Object","assign","install","_Vue","_Router","extend","_bootstrap","_setOptions"],"mappings":"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"}